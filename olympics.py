# -*- coding: utf-8 -*-
"""Olympics.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1BrEBkP9AWGpMtuplFjz_zXsVPaT1dAVn
"""

import pandas as pd

df=pd.read_csv("teams.csv")

df.head()

df.tail(10)

df=df[['team','country','year','athletes','age','prev_medals','medals']]

df.head(10)

#to check if there is any corelation b/w the attribute that need to predict and the other attributes
df.corr()['medals']

import seaborn as sns

sns.lmplot(x='athletes',y='medals',data=df,fit_reg=True,ci=None)

sns.lmplot(y='medals',x='age',data=df,fit_reg=True,ci=None)

df.plot.hist(y='medals')

df[df.isnull().any(axis=1)]

df=df.dropna()

df[df.isnull().any(axis=1)]

test=df[df['year']>2008].copy()

test

train=df[df['year']<=2008].copy()

train

train.shape

from sklearn.linear_model import LinearRegression
reg=LinearRegression()

predicators=['athletes','prev_medals']
target='medals'

reg.fit(train[predicators],train[target])

predictions=reg.predict(test[predicators])

test['predictions']=predictions

test.loc[test['predictions']<0,'predictions']=0

test['predictions']=test['predictions'].round()

from sklearn.metrics import mean_absolute_error

error=mean_absolute_error(test['medals'],test['predictions'])

error

test[test['team']=='USA']

test[test['team']=='IND']